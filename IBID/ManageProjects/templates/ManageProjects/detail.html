{% extends 'base.html' %}
{% load crispy_forms_tags %}
{% load idea_extras %}

{% block body_middle_block-6 %}

 <div class="panel panel-default">
    <div class="panel-heading clearfix" >
      <h3 class="panel-title pull-left" style="padding-top: 5px;"><span class="glyphicon glyphicon-gift" aria-hidden="true"></span> <b>  {{ project.title }}</b>
      </h3>
    </div>
    <div class="panel-body">
      <div class="clearfix">
        <div class="pull-right">
          {% if request.user|has_group:'staff' %}
          <a href="{% url 'ManageProjects:edit_project' project.id%}" class="btn btn-default btn-sm"> <span class="glyphicon glyphicon-pencil" aria-hidden="true"></span>
          </a>
          {% endif %}
        </div>
        <h4> Meta </h4>
      </div><hr> 
      <div class="row">
        <div class="col-sm-8 text">
          <div class="list-group">
            <b class="list-group-item-heading">Kurzbeschreibung</b></br>
            {% if project.description_short %}
              {{ project.description_short | linebreaks }}
            {% else %}
              Noch keine Kurzbeschreibung vorhanden
            {% endif %}
          </div>
          <div class="list-group">
            <b class="list-group-item-heading">Langbeschreibung</b></br>
            {% if project.description_long %}
              {{ project.description_long | linebreaks }}
            {% else %}
              Noch keine Langbeschreibung vorhanden
            {% endif %}
          </div>
          <div class="list-group">
            <b class="list-group-item-heading">Allgemeine Bemerkung</b><br>
            {% if project.general_note %}
              {{ project.general_note | linebreaks }}
            {% else %}
              Keine allgemeinen Bemerkungen vorhanden
            {%endif%}
          </div>
        </div>
        <div class="col-sm-4 text">
          <b class="list-group-item-heading">Projektteilnehmer</b></br>
          <div class="list-group">
            {% for membership in project.membership_set.all%}
              <a href="{% url 'ManageUsers:userprofile' membership.member.id %}">
                {{ membership.member.first_name }} {{ membership.member.last_name }}
              </a>
              {% if request.user|can_edit:membership %}
                (<a href="{% url 'ManageProjects:edit_membership' project.id membership.id  %}"> edit </a>)
              {% endif %}
              <br>
            {% endfor %}
            {% if request.user|can_edit:project %}
            <a href="{% url 'ManageProjects:addmember' project.id %}" class="btn btn-default btn-xs">
              <span class="glyphicon glyphicon-plus" aria-hidden="true"></span>
            </a>
            {% endif %}
          </div>
          <b class="list-group-item-heading">Status</b></br>
          <div class="list-group">
            {% if project.status %}
              <span class="label label-{{project.status.appearance}}">{{project.status}}</span>
            {% endif %}
          </div>
           <b class="list-group-item-heading">Hauptbetreuer</b></br>
          <div class="list-group">
            <b></b>
            {% if project.supervisor %}
              {{project.supervisor.first_name}} {{project.supervisor.last_name}}
            {% endif %}
          </div>
        </div>
        
      </div> 
      <div class="clearfix">
        <div class="pull-right">
          {% if request.user|has_group:'staff' %}
          <a href="{% url 'ManageProjects:create_note' project.id %}" class="btn btn-default btn-sm"> <span class="glyphicon glyphicon-plus" aria-hidden="true"></span>
          </a>
          {% endif %}
        </div>
        <h4> Notizen </h4>
      </div><hr>  
      {% for note in project.note_set.all %}  
        <div class="row">
          <div class="col-md-1 col-sm-1">
            <span class="glyphicon glyphicon-comment" aria-hidden="true"></span>
          </div>
          <div class="col-md-11 col-sm-11">
            <p class="list-group-item-text">
              <p>
                <b> {{note.supervisor.first_name}} {{note.supervisor.last_name}} </b> (<i>{{note.contact_type}}</i>)
                am <i>{{note.action_date}}</i> 
              </p>
              <div class="well well-sm">{{note.text}}</div>
              <p align="right">
               <i>{{ note.time_spend|format_duration }}</i>
              </p>
            </p>
          </div>
        </div>
        {% if forloop.last %} 
        <span class="dboverlined-right"><b><i>{{project.note_set.all|total_duration}}</i></b> </span>
        
        {% endif %}
      {% endfor %} 
    </div>
  </div>



{% endblock %}









